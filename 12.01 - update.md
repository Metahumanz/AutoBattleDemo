# 🛡️ 虚幻4 + C++ 《部落冲突》项目开发指南

### 一、 核心开发范式 (这也是拿分关键)
我们要展现的是**C++ 架构能力**，而不是蓝图连线能力。
*   **黄金法则**：**C++ 写逻辑 (Logic)，蓝图配资源 (Assets)**。
*   **严禁**：在场景里直接拼凑方块，或者在关卡蓝图里写逻辑（这是 0 分做法）。
*   **正确流程**：
    1.  **VS 中写 C++ 类**（定义属性 `Health`，定义功能 `Attack()`）。
    2.  **UE 中建蓝图子类**（继承你的 C++ 类，把模型设为球体/方块，把 `Health` 设为 100）。
    3.  **拖入场景**（让蓝图实例化）。

---

### 二、 必须注意的“超级踩坑点” ⚠️

#### 1. 协作与 Git 的死穴
*   **坑**：UE4 的 `.uasset/.umap` (蓝图/地图) 是二进制文件，**无法合并**。如果两人同时修改同一个蓝图，后提交的人会覆盖前一个人的工作。
*   **解**：
    *   **分工物理隔离**：A 专职改地图代码，B 专职改兵种蓝图，C 专职改 UI。
    *   **互斥锁**：如果要改同一个文件，群里吼一声，别人别动。
    *   **不要上传垃圾**：严格使用 `.gitignore`，不要上传 `Binaries`, `Intermediate` 等文件夹。

#### 2. 编译报错 “Undeclared Identifier” / “Linker Error”
*   **坑**：在 `.cpp` 里写了函数实现，却忘了在 `.h` 头文件里声明。或者 C++ 类继承关系写错。
*   **解**：
    *   **铁律**：`.h` 是菜单，`.cpp` 是厨房。要做菜（写逻辑）前，必须先在菜单（头文件）上写好名字。
    *   **父类引用**：如果在 GameMode 里用了 Controller，必须在头文件 `#include "MyController.h"`。
    *   **构造函数**：如果你在 `.cpp` 里写了 `AMyClass::AMyClass() { ... }`，头文件里必须有 `AMyClass();`。

#### 3. 蓝图里找不到父类的变量/组件
*   **坑**：创建蓝图时选了默认的 `Object` 或 `Actor`，导致跟你的 C++ 代码没关系。或者选中了组件却想改 Actor 的属性。
*   **解**：
    *   **检查父类**：蓝图编辑器右上角必须显示 `Parent Class: YourCppClass`。如果不对，去 `File -> Reparent Blueprint` 修改。
    *   **找对位置**：要修改 `MaxHealth` 这种 C++ 定义的变量，点击左侧的 **(Self)**，然后在右侧 Details 面板找（通常在 Stats 分类下）。

#### 4. 鼠标点不到东西 / 没有反应
*   **坑 1**：没有开启鼠标交互。
    *   **解**：必须写一个 C++ `PlayerController`，在构造函数里设 `bShowMouseCursor = true`，并在 `GameMode` 里指定使用这个 Controller。
*   **坑 2**：点到了但没触发代码。
    *   **解**：确保 C++ 里覆盖了 `NotifyActorOnClicked` 函数。
*   **坑 3**：点击穿透了（Character 专属坑）。
    *   **解**：`Character` 类判定点击靠的是**胶囊体 (Capsule Component)**。如果你的模型（比如球体）比胶囊体大，或者偏离了胶囊体，鼠标点在模型上是没用的。**按 `~` 输入 `show collision` 检查胶囊体是否包住了你的模型。**

#### 5. 士兵模型无法设置 (Character 的坑)
*   **坑**：继承自 `ACharacter` 的类，自带的 Mesh 只能放骨骼模型（小人），放不了方块/球体。
*   **解**：在蓝图里点 **Add Component**，手动加一个 **Static Mesh Component**，把球体放在这个新组件里。

---

### 三、 目前的项目架构 (已完成部分)

我们已经搭建好了符合 PDF 要求的底层框架：
1.  **RTSGameMode** (C++): 指定游戏规则，加载我们的控制器。
2.  **RTSPlayerController** (C++): 开启鼠标，管理点击事件。
3.  **BaseBuilding** (C++): 防御塔基类，实现了点击扣血功能。
4.  **BaseSoldier** (C++): 士兵基类，继承自 `ACharacter`，实现了多态攻击接口和血量系统。

**接下来的方向**：
*   **成员 A**：完善地图格子系统 (Grid)，不要依赖物理碰撞，用二维数组管理坐标。
*   **成员 B**：完善 `BaseSoldier` 的 `Attack` 逻辑，制作不同的兵种蓝图。
*   **成员 C**：制作 UI，把 Output Log 里的扣血提示变成头顶的血条。

祝我们项目顺利！🚀